module DASHI.Algebra.OperatorMonoidClosed where

open import Agda.Builtin.Equality using (_≡_; refl)

postulate State : Set

Endo : Set
Endo = State → State

_∘_ : Endo → Endo → Endo
(f ∘ g) s = f (g s)

id : Endo
id s = s

-- The closure generated by a seed operator K (a free monoid in Endo)
data Gen (K : Endo) : Endo → Set₁ where
  gen-id   : Gen K id
  gen-base : Gen K K
  gen-comp : ∀ {f g} → Gen K f → Gen K g → Gen K (f ∘ g)

-- Now “closure” is literal:
closed-under-comp :
  ∀ {K : Endo} {f g : Endo} →
  Gen K f → Gen K g → Gen K (f ∘ g)
closed-under-comp = gen-comp
